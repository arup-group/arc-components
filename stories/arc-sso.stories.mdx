import { Meta, Story, Canvas, ArgsTable } from '@web/storybook-prebuilt/addon-docs/blocks.js';
import * as stories from '../out-tsc/components/sso/arc-sso.stories.js';

<Meta
title='ArcSSO [Experimental]'
component='arc-sso'
argTypes={{
    clientId: {
      name: 'client-id',
      description: 'The id of your application. This value can be found on the Azure AD portal.',
      defaultValue: { summary: '' },
      control: { type: 'text' },
    },
    tenantId: {
      name: 'tenant-id',
      description: 'Identifies which Azure AD instance the application sits under. The default `common` value is used for multi-tenant applications and applications allowing personal accounts (not B2C). If your application audience is single-tenant, you must provide this property. This value can be found on the Azure AD portal.',
      defaultValue: { summary: 'common' },
      control: { type: 'text' },
    },
    redirectUri: {
      name: 'redirect-uri',
      description: 'The location where the authorization server sends the user once the app has been successfully authorized and granted an authorization code or access token. This url needs to be specified in the component and within the Authentication tab on the Azure AD portal.',
      defaultValue: { summary: '' },
      control: { type: 'text' },
    },
    scopes: {
      description: 'A comma separated string that allows for additional permissions on how your app must interact with the Microsoft identity platform. More about this can be found on https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-permissions-and-consent.',
      defaultValue: { summary: 'openid, profile, User.Read' },
      control: { type: 'text' },
    }
}}
parameters={{
  actions: {
    handles: ['arc-auth'],
  },
}} />

# ArcSSO [Experimental]
### `<arc-sso>`

The ArcSSO is used to authenticate users using Azure AD work and school accounts (AAD),
Microsoft personal accounts (MSA) and social identity providers like Facebook, Google, LinkedIn, Microsoft accounts, etc. through Azure AD B2C service.
It also enables your app to get tokens to access Microsoft Cloud services such as Microsoft Graph.

<Canvas>
  <Story name="Default" story={stories.Default} />
</Canvas>

## Authenticating
### SignIn
By default, the component provides a simple [arc-button](?path=/story/arcbutton--default) with the `type=tab` property.
Clicking this button will trigger a dialog that allows you to sign in to your Microsoft account.

You can overwrite this default behaviour by slotting your own styled component into the `login` slot.
You can then call the signIn() method on the `arc-sso` component to trigger the sign-in flow.

Example:
```bash
<arc-sso client-id='your-client-id' tenant-id='your-tenant-id' redirect-uri='your-redirect-uri' scopes='your-comma-separated-scopes'>
  <button slot='login' onClick='this.parentElement.signIn()'>Custom signIn button</button>
</arc-sso>
```

### SignOut
By default, the component provides an [arc-dropdown](?path=/story/arcdropdown--default) that displays your username
and provides a single item that allows you to sign out.

You can overwrite this default behaviour by slotting your own styled component into the `logout` slot.
You can then call the signOut() method on the `arc-sso` component to trigger the sign-out flow.

Example:
```bash
<arc-sso client-id='your-client-id' tenant-id='your-tenant-id' redirect-uri='your-redirect-uri' scopes='your-comma-separated-scopes'>
  <button slot='logout' onClick='this.parentElement.signOut()'>Custom signOut button</button>
</arc-sso>
```

### GetAccount
Retrieving the account of the user that is signed in, can be useful.
By calling the getAccount() method on the `arc-sso` component you can retrieve the information of the user.
You can also listen to the `arc-auth` event, which gets triggered whenever the internal authentication state of the component changes.

## Properties
<ArgsTable story="Default" />

## Events

| Name         | Description                                                              |
|--------------|--------------------------------------------------------------------------|
| arc-auth     | Emitted when the internal authentication state of the component changes. |

## Methods

| Name            | Description                                            |
|-----------------|--------------------------------------------------------|
| signIn          | Attempts to sign in through Azure AD.                  |
| signOut         | Attempts to sign out from Azure AD.                    |
| getAccount      | Retrieve the Azure AD account.                         |

## Slots

| Name         | Description                                               |
|--------------|-----------------------------------------------------------|
| login        | Used to overwrite the default login slot.                 |
| logout       | Used to overwrite the default logout slot.                |

## Dependencies

This component imports the following dependencies.
* [arc-dropdown](?path=/story/arcdropdown--default)
* [arc-button](?path=/story/arcbutton--default)
* [arc-icon-button](?path=/story/arciconbutton--default)
* [arc-menu](?path=/story/arcmenu--default)
* [arc-menu-item](?path=/story/arcmenuitem--default)
